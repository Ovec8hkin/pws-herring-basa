# exploit_rate.R
# Created by Melissa Muradian
# Date updated:  12/14/2016
# Summary:
# This function the exploitation rate with 95% credibility intervals in each year

## Plot biomass
exploit_rate <- function(exploit.median, exploit.ci, years, nYr, myMGP, ylabel, xlabel, labels.x, labels.y) {
    ## Exploitation Rate plot - from Catches.R
    font.size <- 1
    years<-years[1:(nYr)]
    #par(mar=c(3,3,1,3))
    
    if(xlabel){
      xlabel <- "Year"
    }else{
      xlabel <- NA
    }
    if(ylabel){
      ylabel <- "Exploitation rate"
    }else{
      ylabel <- NA
    }
    # Plot CI polygon with median rate using posterior median as a point with lines of .95 intervals 
    plot(years, rep(0, nYr), 
         type="l", lwd=2, las=1, 
         xaxs="i", yaxs="i", ylab=ylabel, xlab=xlabel, ylim=c(0, 0.3), 
         mgp=myMGP, cex.lab=font.size, xpd=NA, axes=F)
    axis(1, at=years, labels=F, tcl=-.15, col="grey60")
    axis(1, at=seq(years[1], years[length(years)], 5), labels=labels.x, tcl=-0.35, lwd.ticks=2, cex.axis=font.size-0.2, mgp=myMGP, col="grey60")
    axis(2, at=seq(0, 0.5, 0.1), labels=labels.y, las=1, mgp=myMGP, cex.axis=font.size-0.2, col="grey60")
    points(x=years, y=t(exploit.median), pch=19, xpd=T)
    points(x=years[c(which(is.na(exploit.median)), nYr)], y=c(rep(0, length(which(is.na(exploit.median)))), NA), pch=1, xpd=T)
    segments(x0=years, x1=years, y0=c((exploit.ci[1, ]), NA), y1=c((exploit.ci[2, ]), NA), xpd=T, lwd=2)
}
